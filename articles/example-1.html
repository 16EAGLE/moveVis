<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Creating a simple movement animation • moveVis</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Creating a simple movement animation">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">moveVis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../index.html#get-started">Get Started</a></li>
<li class="nav-item"><a class="nav-link" href="../index.html#examples">Examples</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-other-packages" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Other packages</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-other-packages">
<li><a class="external-link dropdown-item" href="https://jakob.schwalb-willmann.de/basemaps">basemaps</a></li>
    <li><a class="external-link dropdown-item" href="https://bleutner.github.io/RStoolbox/">RStoolbox</a></li>
    <li><a class="external-link dropdown-item" href="https://jakob.schwalb-willmann.de/getSpatialData/">getSpatialData</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://bsky.app/profile/schwalb-willmann.de"><span class="fa fa-brands fa-bluesky fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://www.github.com/16eagle"><span class="fa fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://jakob.schwalb-willmann.de"><span class="fa fa-globe fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Creating a simple movement animation</h1>
            
      

      <div class="d-none name"><code>example-1.Rmd</code></div>
    </div>

    
    
<p>First, load the required packages for this example and the
<code>moveVis</code> example movement data:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://movevis.org">moveVis</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bartk.gitlab.io/move/" class="external-link">move</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster" class="external-link">raster</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"move_data"</span><span class="op">)</span></span></code></pre></div>
<p><code>move_data</code> is a <code>moveStack</code>, containing three
individual tracks. <code>moveVis</code> works with <code>move</code>
class objects. If your movement tracks are present as
<code>data.frames</code>, see
<a href="http://movevis.org/reference/df2move.html" class="external-link"><code>df2move()</code></a>
and the example code there for conversion. Let’s have a look at both
timestamps and sampling rates of <code>move_data</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu">timestamps</span><span class="op">(</span><span class="va">move_data</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">timeLag</span><span class="op">(</span><span class="va">move_data</span>, unit <span class="op">=</span> <span class="st">"mins"</span><span class="op">)</span></span></code></pre></div>
<p>We can conclude that each track has a sampling rate of roughly 4
minutes, however sampling rates differ over time. Due to this, tracks do
not share unique timestamps. For animation, unique frame times are
needed, regardless if we want to animate a single track or multiple at
once. Thus, we need to align <code>move_data</code> in order to * make
all tracks share unique timestamps that can be assigned to frames * make
all tracks share unique, steady sampling rates without gaps</p>
<p>You can use
<a href="http://movevis.org/reference/align_move.html" class="external-link"><code>align_move()</code></a>
to align <code>move_data</code> to a sampling rate of 4 minutes:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">move_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/align_move.html">align_move</a></span><span class="op">(</span><span class="va">move_data</span>, res <span class="op">=</span> <span class="fl">4</span>, unit <span class="op">=</span> <span class="st">"mins"</span><span class="op">)</span></span></code></pre></div>
<p>Instead, you could apply your own functions for aligning your data,
e.g. using more advanced interpolation methods.</p>
<p>Now, as the movement tracks are aligned, we can pair them with a base
map to create frames that can be turned into an animation later on. You
can use your own custom base map imagery or choose from default map
types. Here is a GIF of some example base maps you can use out of the
box thanks to the
<a href="http://github.com/MilesMcBain/slippymath" class="external-link"><code>slippymath</code></a>
package:</p>
<p align="center">
<img width="700" src="https://raw.githubusercontent.com/16EAGLE/AUX_data/master/data/moveVis_readme/map_types.gif"></p>
<p>You can display a list of all available maps:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># get a list of all available map_services and map_types</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">get_maptypes</span>()<span class="st">`</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="at">$osm</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="at"> [1] "streets"      "streets_de"   "streets_fr"   "humanitarian" "topographic"  "roads"       </span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="at"> [7] "hydda"        "hydda_base"   "hike"         "grayscale"    "no_labels"    "watercolor"  </span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="at">[13] "toner"        "toner_bg"     "toner_lite"   "terrain"      "terrain_bg"   "mtb"         </span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="at">$carto</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="at"> [1] "light"                "light_no_labels"      "light_only_labels"    "dark"                </span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="at"> [5] "dark_no_labels"       "dark_only_labels"     "voyager"              "voyager_no_labels"   </span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="at"> [9] "voyager_only_labels"  "voyager_labels_under"</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="at">$mapbox</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="at"> [1] "satellite"     "streets"       "streets_basic" "hybrid"        "light"        </span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="at"> [6] "dark"          "high_contrast" "outdoors"      "hike"          "wheatpaste"   </span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="at">[11] "pencil"        "comic"         "pirates"       "emerald"      </span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a></span></code></pre></div>
<p>Currently, you can use more than 40 types of maps, provided by
<code>OpenStreetMap</code>, <code>Carto</code> (both free without
registration) and <code>Mapbox</code> (free, but registration required).
Most maps display thematic or terrain data, while <code>Mapbox</code>
also offers satellite imagery (see
<a href="http://movevis.org/articles/example-3.html" class="external-link">Example 3: using a
mapbox satellite base map</a> for details on how to register and use
mapbox).</p>
<p>In this example, we want to use the OpenStreetMap ‘watercolour’
imagery with a transparency of 50% to start with something nice looking
and colourful. To create a list of spatial frames from
<code>move_data</code> using a map, we can use
<code><a href="../reference/frames_spatial.html">frames_spatial()</a></code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">frames</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/frames_spatial.html">frames_spatial</a></span><span class="op">(</span><span class="va">move_data</span>, path_colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"green"</span>, <span class="st">"blue"</span><span class="op">)</span>,</span>
<span>                         map_service <span class="op">=</span> <span class="st">"osm"</span>, map_type <span class="op">=</span> <span class="st">"watercolor"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p>Instead of using <code>path_colours</code>, you can add a
<code>colour</code> column to your <code>move</code> or
<code>moveStack</code> object. This allows you to colour your movement
tracks as you want, e.g. not only by individual track, but by behavioral
segment, time, age, speed or something different (see
<a href="http://movevis.org/reference/frames_spatial.html" class="external-link"><code>?frames_spatial</code></a>
for details).</p>
<p>Have a look at the newly created <code>frames</code> list object and
display a randomly selected frame to get a first impression, how your
animation will look like:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">frames</span><span class="op">)</span> <span class="co"># number of frames</span></span>
<span><span class="va">frames</span><span class="op">[[</span><span class="fl">100</span><span class="op">]</span><span class="op">]</span> <span class="co"># display one of the frames</span></span></code></pre></div>
<p align="center">
<img width="700" src="https://raw.githubusercontent.com/16EAGLE/AUX_data/master/data/moveVis_readme/readme_example1_01.png"></p>
<p>You can pass any list of frames like the one we just created to
<code><a href="../reference/animate_frames.html">animate_frames()</a></code>. This function will turn your frames into
an animation, written as a GIF image or a video file. For now, we do not
want to add any customization to <code>frames</code> and just create a
<code>GIF</code> from it. If you are not sure, which output formats can
be used, run <code><a href="../reference/suggest_formats.html">suggest_formats()</a></code> that returns you a vector of
file suffixes that can be created on your system. For making a
<code>GIF</code> from <code>frames</code>, just run:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/animate_frames.html">animate_frames</a></span><span class="op">(</span><span class="va">frames</span>, out_file <span class="op">=</span> <span class="st">"example_1.gif"</span><span class="op">)</span></span></code></pre></div>
<p align="center">
<img width="700" src="https://raw.githubusercontent.com/16EAGLE/AUX_data/master/data/moveVis_readme/readme_example1_opt.gif"></p>
<p>We have just used an <code>OSM</code> base map that does not contain
any map labels. How would the same frames look like with a standard
<code>OSM</code> streets base map?</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">frames</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/frames_spatial.html">frames_spatial</a></span><span class="op">(</span><span class="va">move_data</span>, path_colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"green"</span>, <span class="st">"blue"</span><span class="op">)</span>,</span>
<span>                         map_service <span class="op">=</span> <span class="st">"osm"</span>, map_type <span class="op">=</span> <span class="st">"streets"</span>, map_res <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="va">frames</span><span class="op">[[</span><span class="fl">100</span><span class="op">]</span><span class="op">]</span> <span class="co"># display one of the frames</span></span></code></pre></div>
<p align="center">
<img width="700" src="https://raw.githubusercontent.com/16EAGLE/AUX_data/master/data/moveVis_readme/readme_example1_02.png"></p>
<p>You may recognize that the map seems to be distorted which becomes
mainly visible when looking at the map labels. By default,
<code>moveVis</code> calculates an equidistant map extent (squared),
with y and x axis measuring equal surface distances. In addition,
<code>moveVis</code> reprojects the default base maps to the projection
of your movement data. The default base maps are originally projected as
<code>WGS 84 / Pseudo Mercator</code> (<code>epsg:3857</code>), also
referred to as <code>Web Mercator</code>, and thus are squeezed or
stretched onto the projection grid of the movement data (in this case
<code>WGS 84 / LatLon</code>).</p>
<p>To represent the base map in its original projection, just reproject
your movement data to the <code>WGS 84 / Pseudo Mercator</code>
projection and disable the calculation of an equidistant extent:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">move_data</span> <span class="op">&lt;-</span> <span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://edzer.github.io/sp/reference/spTransform.html" class="external-link">spTransform</a></span><span class="op">(</span><span class="va">move_data</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/crs.html" class="external-link">crs</a></span><span class="op">(</span><span class="st">"+init=epsg:3857"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">frames</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/frames_spatial.html">frames_spatial</a></span><span class="op">(</span><span class="va">move_data</span>, path_colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"green"</span>, <span class="st">"blue"</span><span class="op">)</span>,</span>
<span>                         map_service <span class="op">=</span> <span class="st">"osm"</span>, map_type <span class="op">=</span> <span class="st">"streets"</span>, map_res <span class="op">=</span> <span class="fl">0.8</span>, equidistant <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">frames</span><span class="op">[[</span><span class="fl">100</span><span class="op">]</span><span class="op">]</span> <span class="co"># display one of the frames</span></span></code></pre></div>
<p align="center">
<img width="700" src="https://raw.githubusercontent.com/16EAGLE/AUX_data/master/data/moveVis_readme/readme_example1_03.png"></p>
<p>Finally, animate the newly created frames:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/animate_frames.html">animate_frames</a></span><span class="op">(</span><span class="va">frames</span>, out_file <span class="op">=</span> <span class="st">"example_1b.gif"</span>, width <span class="op">=</span> <span class="fl">700</span>, height <span class="op">=</span> <span class="fl">500</span>, res <span class="op">=</span> <span class="fl">80</span><span class="op">)</span></span></code></pre></div>
<p align="center">
<img width="700" src="https://raw.githubusercontent.com/16EAGLE/AUX_data/master/data/moveVis_readme/readme_example1b.gif"></p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jakob Schwalb-Willmann, Annika Ludwig.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
